contract SmartFix {
  bool public _locked = false;

  modifier _nonReentrant() {
    require(!_locked);
    _locked = true;
    _;
    _locked = false;
  }
}

pragma solidity ^0.4.23;

/*
!!! THIS CONTRACT IS EXPLOITABLE AND FOR EDUCATIONAL PURPOSES ONLY !!!

This smart contract allows a user to (insecurely) store funds
in this smart contract and withdraw them at any later point in time
*/

contract keepMyEther is SmartFix {
    mapping(address => uint256) public balances;
    
    function () _nonReentrant /* <FIX> Add Modifier:NR */ payable public {
        require(((balances[msg.sender] + msg.value) >= balances[msg.sender])); /* <FIX> Insert:BC */
        balances[msg.sender] += msg.value;
    }
    
    function withdraw() _nonReentrant /* <FIX> Add Modifier:NR */ public {
        msg.sender.call.value(balances[msg.sender])(); /* <RE_ENT>, <RE_VUL> */
        balances[msg.sender] = 0;
    }
}
